ID_limit <- 10
n_bootstraps <- 50
potential_KBAs <- levels(genetic_info@pop)
KBAs_enough_IDs <- potential_KBAs[table(genetic_info@pop) >= ID_limit]

# save bootstraped genind
subsamples_list <- vector("list", n_bootstraps)

for(i in 1:n_bootstraps){
  sampled_inds <- unlist(
    lapply(KBAs_enough_IDs, function(KBA) {
      IDs <- which(genetic_info@pop == KBA)
      sample(IDs, ID_limit)
    })
  )
  
  subsamples_list[[i]] <- genetic_info[sampled_inds]
}

